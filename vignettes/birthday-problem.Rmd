---
title: "birthday-problem"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{birthday-problem}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(MATH4753)
```
## Introduction

The birthday problem asks: **What is the probability that in a group of $n$ people, at least two share the same birthday?**  

## 1: Mathematical Derivation 

Let $A$ = event that at least two people share a birthday.  
Let $A^c$ = event that all people have different birthdays.  

\[
P(A) = 1 - P(A^c)
\]

The probability that all $n$ birthdays are distinct is:

\[
P(A^c) = \frac{365}{365} \cdot \frac{364}{365} \cdot \frac{363}{365} \cdots \frac{365-n+1}{365}
\]

\[
= \frac{365!}{(365-n)! \, 365^n}
\]

Thus, the probability of a shared birthday is:

\[
P(A) = 1 - \frac{365!}{(365-n)! \, 365^n}
\]

---

## 2: Reformulation Using Log Functions

From the derivation we had:

\[
P(A) = 1 - \frac{365!}{(365-n)! \, 365^n}
\]

Notice that:

\[
\frac{365!}{(365-n)!} = \binom{365}{n} \cdot n!
\]

Taking logs:

\[
\log \frac{365!}{(365-n)!} = \log \binom{365}{n} + \log(n!)
\]

So the probability becomes:

\[
P(A) = 1 - \exp \Big( \log \binom{365}{n} + \log(n!) - n \log(365) \Big)
\]

---

R code for logarithims: 

- `lfactorial(n)` computes $\log(n!)$  
- `lchoose(365, n)` computes $\log \binom{365}{n}$  

Thus, the reformulation is written as:

```{r, eval=FALSE}
1 - exp(lchoose(365, n) + lfactorial(n) - n * log(365))
```

## 3: The Birthday Function
R code for birthday function
```{r}
#' Birthday Problem
#'
#' Computes the probability that at least two people in a group of size `k`
#' share the same birthday, assuming 365 equally likely birthdays and ignoring leap years.
#'
#' @param k Integer. The number of people in the group.
#' @returns A numeric value giving the probability.
#' @export
birthday <- function(k) {
  1 - exp(lchoose(365, k) + lfactorial(k) - k * log(365))
}
```

## 4: Example
```{r}
birthday(20:25)
```
